import numpy as np
import matplotlib.pyplot as plt
from matplotlib import cm

def generate_compact_3d_plot():
    # 1. Setup Mathematical Data
    # Using 100 points is sufficient for a smooth look without lag
    x_val = np.linspace(-12, 12, 100)
    y_val = np.linspace(-150, 150, 100)
    X, Y = np.meshgrid(x_val, y_val)
    
    m_exp = 6
    
    # 2. Calculate Residuals: Z = log10(|y^3 + xy - x^6 - 4| + 1)
    LHS = Y**3 + X*Y
    RHS = X**m_exp + 4
    Z = np.log10(np.abs(LHS - RHS) + 1)

    # 3. Plotting Configuration
    # Smaller figsize (8x6) ensures it fits fully on most screens
    fig = plt.figure(figsize=(8, 6), dpi=150)
    ax = fig.add_subplot(111, projection='3d')
    
    # 4. Surface Plot with Wireframe
    # rcount/ccount controls grid density (lower = cleaner on small screens)
    surf = ax.plot_surface(X, Y, Z, cmap='turbo', 
                           linewidth=0.3, edgecolors='black', alpha=0.9,
                           rcount=30, ccount=30, antialiased=True)

    # 5. Clean Styling (White Paper Look)
    # Remove gray background panes
    ax.xaxis.pane.fill = False
    ax.yaxis.pane.fill = False
    ax.zaxis.pane.fill = False
    # White edges
    ax.xaxis.pane.set_edgecolor('w')
    ax.yaxis.pane.set_edgecolor('w')
    ax.zaxis.pane.set_edgecolor('w')
    # Remove background grid
    ax.grid(False) 

    # 6. Labels - optimized for visibility
    # Increased labelpad pushes text away from the graph to prevent overlap
    ax.set_xlabel('Integer x', fontsize=10, fontweight='bold', labelpad=10)
    ax.set_ylabel('Integer y', fontsize=10, fontweight='bold', labelpad=10)
    ax.set_zlabel('Log Residual', fontsize=10, fontweight='bold', labelpad=12)
    
    # Title
    ax.set_title(r'3D Residual Landscape: $y^3 + xy = x^6 + 4$', fontsize=12, y=0.95)

    # 7. Adjust View Angle
    # elev=30, azim=-125 gives a clear view of the "valley" and all axes
    ax.view_init(elev=30, azim=-125)

    # 8. Axis Ticks - Reduce size slightly for compactness
    ax.tick_params(axis='both', which='major', labelsize=8)

    # 9. Colorbar - Compact and positioned clearly
    cbar = fig.colorbar(surf, ax=ax, shrink=0.5, aspect=10, pad=0.1)
    cbar.set_label('Error Magnitude (Log Scale)', fontsize=9)
    cbar.ax.tick_params(labelsize=8)

    # Tight layout helps fit everything within the figure bounds
    plt.tight_layout()
    plt.show()

if __name__ == "__main__":
    generate_compact_3d_plot()
